.. _tq_chart:

绘制自定技术指标和其它图形
=========================================================================
在天勤中打开策略专属行情图
--------------------------------------------------------------------------
策略程序在天勤中运行时, 会自动获得一个专属行情窗口. 在天勤的策略管理器中，右键点击策略，选择【显示图表】即可看到。

策略程序可以通过一些语句在这个窗口中绘图。


绘制数据序列
--------------------------------------------------------------------------
要绘制一个数据序列，仅需将要绘制的序列数据放入对应K线数据包中。如下所示::

    klines_1905 = api.get_kline_serial("SHFE.cu1905", 86400)
    klines_1906 = api.get_kline_serial("SHFE.cu1906", 86400)
    klines_1905["dif"] = klines_1906["close"] - klines_1905["close"]

这段代码运行后，会在 cu1905 的k线图上绘制出一个价差序列


绘制其它图形
--------------------------------------------------------------------------
如果要绘制的内容不是一个时间序列，TqApi 提供了以下绘图函数:

* :py:meth:`~tqsdk.api.TqApi.draw_box` - 绘制方框::

    # 给主图最后5根K线加一个方框
    api.draw_box(klines, x1=-5, y1=klines.iloc[-5]["close"], x2=-1, y2=klines.iloc[-1]["close"], width=1, color=0xFF0000FF, bg_color=0x8000FF00)

* :py:meth:`~tqsdk.api.TqApi.draw_text` - 绘制文字::

    # 在主图最后一根K线的最高处标一个"最高"文字
    indic = -1
    value = klines["high"].iloc[-1]
    api.draw_text(klines, "最高", x=indic, y=value, color=0xFF00FF00)

* :py:meth:`~tqsdk.api.TqApi.draw_line` - 绘制直线/射线/线段


这部分的完整示例程序请见 t90.py

